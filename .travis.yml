language: go
go:
- 1.x
services:
- mongodb
- docker
before_install:
  - docker login --username=$DOCKER_HUB_USERNAME --password=$DOCKER_HUB_PASSWORD
  - openssl aes-256-cbc -K $encrypted_f9907a2bc3a1_key -iv $encrypted_f9907a2bc3a1_iv -in deploy_key.enc -out ./deploy_key -d
  - docker-compose -f docker-compose.yml -f docker-compose.prod.yml build
  - docker-compose -f docker-compose.yml -f docker-compose.prod.yml push
git:
  depth: 3
deploy:
  provider: script
  skip_cleanup: true
  script: chmod 600 deploy_key && ssh -o StrictHostKeyChecking=no -i deploy_key root@104.131.43.177 ./deploy.sh
  on:
    branch: master
env:
  global:
  - secure: dgM97FViCmdCjC1xivDdCzTER8Nj2PW/y1c6QsEFYX8mW61jVkPLKgPAe/LgxpOaAxMRqoVZcj2cnITXIl2unav5aiM128nhP/OlCaHKVzkvvqVsebhC2j0g89mxlVNQCh5ISIAKx9/0OPsraxiDAEv1CqUaPhD+l3fY0lQgKVecuT+NURJuUPcW0/gTDyGgvo7cfKjWYtOa0loGmA+6B4pnTGtBhJkzoCmq1ck+51/enQZGVPeZbEuwDzsyylGyW+AE0Gm8PX0sBIjnTjbDVxK7nZyr612U0I8yb//Hz0t183UFVVvJ+oQBq08hcubSxPJmD/hMlhK5IrABDVbXxPsqepIHo+aI4vdkuedMefp4dTYzGJggP2x00F6lVTabLCaii1upWiQGnvVKVyKwAHeygaEYa/VrPg7UOXZ+l8kgXTjCKf9WeWXZKbBi+VRPrcE6cRluyRtB8B8Emw8ajedPJi57Y7lLQy//j/Hhx8TIBE4S4snhEkUCrAh06QRQuz1DjQUlkR0sIQoamaQmBTlXCpJ3jEWHz+FY+LfzUNgqzxlI44+UDabr2hNYDhMZK3ntIJ+6Z9+YxFEI1oqQ9aPULTHhHz7gSSaIFhu57d09IoFiSGsp31z7axWscSRMtzuDI9hcpFC427TAcxMyjZjClVnx+KkTiYcSNfkx0PQ=
  - secure: FuXbrt9H96MHMMeOgnpC80oeSNLdBrkydHSKZFf0yewX2fB6FX9juFOpiciAIuh9goH8BNKEG3eN8l419L112jr65By9AM4mJCeh0cnkOwt6spifYf0vjW6M0V2RvltKDq6SZWgc90FHzIpoPlbSYxKTD3vMOGkBnEL/VzZS6yqKhlWM+iWcThgTJ9ILv4Zct5dSCYiOLr7f1zDxcdRkJsgk87LDZ1fKv8a2i9AHRAQxSMascB5C0Zb2MeHbw8l7Nf7nq4Aa4U/r1wj5aT6iBVv9Zm55svM0DuTpMbVbGwzLL34axXoSx55DSOvzVLJ5JpnX3SrZW14c5dVRP5W5btXTT8R6Zk/p6uN3djuJlfAwKQxFKLJWme3YzoB0KEHOzgQ0hDIdkTHskgNaS3ZKUZh3ZtKDZY/RDvcDc0svxmWQ675HnIcd8chZFV/lrudcPhMknpRxjFlPDG6jQU16CNpE5b7QFsuKPC88cTEWfD6Fpc0K5BNoA9wTYi6aOGPxC3F9reHX6H7uHTcvmRpAMapgEie32EW+AADiTOLdABsQiUDUhbpcIsrUpdsiOPMJu49stKg799SBXoBRA/GfHeyHllfQMcr+G/WnjZHgMiwbEiy/Kte4Cnjxsd7GE15m72rq6sATs/WkyY9HV09TwiSf6hsHMfkExhr3nwKXtoA=
  - secure: H0XYi3RtlE/iZWRRDOpgtquNtrw/zmZfmE5No0bEzwN56lRhh5VfKpDwNYPUIRjUzh1oHwCLbc9r9KCx+anJDKc0Yay/537u3vZ8+DfhZHywH/1O7Jv7K1AoIrPI+OsZIpTF/4AVG+fwdWpkyUN00zykBSDVpgbFPl0cIktudr0blTsH5EBo+1cfK2T7FEtTKjJfTlYS0Ouv3h4jEMIySngBgLHklhsPGaSRLyrvK8Duc7/z/mXJIDbXzrTtWQkLy5SnPfNZ8m14ikowRx7d6Zp2OMnB4WDjOp7JlbTboe+otVFpgF33KKbtGbk6R91gNd7Xvz6CknUnW+n94nAUG8Y5PxO5DgrGosiAxSnOusgwCEqvWLQbKUeL4n34WbrnTaciZwaDqBlLh8JVicah1mHtHZMRPAoaujK9C61Fo6eQoJVQkz74YAXPPRlA+ReWS7mFDYM2s3JPa/E4GWtgttKw9N8IsaFM03nksgpcuUJBCWborUi1nIe3TpEtEfcW/rB13OvEx1VIUkywXQr1lQ3+u8ZJu3XcYR5JyIQkE5185eyhJqwtTlXD2Z/pDsy/Pwc7JNumWtxx488Od/ORE60gs2z6C/iSP+CYA23A5bIWrRpoHj+U2bUHaLtnzWbPw/lg0RlkZxar9tjwCLdvvNOSQtsBTRxNYCveKWkkGS8=
